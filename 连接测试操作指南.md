# Dev-Linker 连接测试操作指南

**创建日期：** 2025-11-18
**适用版本：** V1.0.0

---

## 🎯 快速开始（3分钟上手）

### 步骤1：启动测试服务器

**在PowerShell中执行：**
```powershell
npm run test:servers
```

**期望输出：**
```
[TCP Server] TCP test server started on port 18888
[WS Server] WebSocket test server started on port 18080
```

**⚠️ 重要：保持这个PowerShell窗口开启，不要关闭！**

---

### 步骤2：启动应用

**新开一个PowerShell窗口，执行：**
```powershell
npm run preview
```

**期望结果：** Dev-Linker 应用窗口打开

---

### 步骤3：找到连接按钮

**界面布局说明：**
```
┌─────────────────────────────────────────────┐
│ Dev-Linker 虚拟4G模块模拟器            [关于]│  ← 顶部导航栏
├──────────────┬──────────────────────────────┤
│              │                              │
│ 连接配置面板  │        数据交互面板          │
│              │                              │
│ 协议类型:    │                              │
│ [下拉选择]   │     (暂无数据)              │
│              │                              │
│ 服务器地址:  │                              │
│ [输入框]     │                              │
│              │                              │
│ 端口: [18080]│                              │
│              │                              │
│ 设备SN:      │                              │
│ [输入框]     │                              │
│              │                              │
│ ┌─────────┐  │                              │
│ │连接服务器│  │   ← 这里就是连接按钮！      │
│ └─────────┘  │                              │
│              │                              │
└──────────────┴──────────────────────────────┘
```

**连接按钮位置：** 左侧"连接配置"面板的最底部

**按钮外观：**
- 默认：蓝色按钮，写着"连接服务器"并有连接图标 🔌
- 连接中：按钮变灰，显示"连接中..."和加载动画
- 已连接：绿色按钮，写着"已连接"并有对勾图标 ✓
- 断开连接：红色按钮（仅连接后出现）

---

### 步骤4：配置连接参数

#### 方案A：WebSocket 连接（推荐新手）

**填写信息：**
- 协议类型：**WebSocket (ws://)** ✓（默认已选）
- 服务器地址：**localhost** ✓（默认已填）
- 端口：**18080** ✓（自动填充）
- 设备SN：输入任意值，如：**TEST-001**

**然后点击：**[连接服务器] 按钮

**期望结果：**
1. 按钮变为"连接中..."状态
2. 2秒后变为"已连接"绿色状态
3. 顶部状态提示变为"已连接"（绿色对勾）

#### 方案B：TCP 连接

**填写信息：**
- 协议类型：选择 **TCP**
- 服务器地址：**localhost**
- 端口：**18888**（自动切换）
- 设备SN：输入任意值，如：**TEST-TCP-001**

**然后点击：**[连接服务器] 按钮

---

### 步骤5：查看服务器日志

**回到运行 `npm run test:servers` 的PowerShell窗口，您应该看到：**

#### WebSocket 连接日志：
```
[WS Server] Client connected: 127.0.0.1, SN: TEST-001
[WS Server] Received: Hello
```

#### TCP 连接日志：
```
[TCP Server] Client connected: 127.0.0.1:54321
[TCP Server] Received: Hello
```

---

### 步骤6：断开连接

**在应用界面中：**
- 点击 **[断开连接]** 红色按钮

**PowerShell中显示：**
```
[WS Server] Client disconnected
```

---

## ❗ 常见问题解决

### Q1: 找不到连接按钮
**现象：** 界面中没有看到"连接服务器"按钮

**解决方案：**
1. 检查是否在左侧面板（连接配置面板）
2. 尝试滚动面板（连接按钮在底部）
3. 检查应用是否完全加载（等待3秒）
4. 刷新应用：按 `F5` 或 `Ctrl + R`

### Q2: 测试服务器启动失败
**现象：** 提示端口被占用

**解决方案：**
1. 关闭所有PowerShell窗口
2. 重新打开PowerShell
3. 执行 `npm run test:servers`

### Q3: 连接按钮点击无反应
**现象：** 点击按钮但状态不变

**解决方案：**
1. 检查测试服务器是否正在运行
2. 检查端口配置是否正确
3. 查看应用是否有错误提示
4. 重启应用：`npm run preview` 重新执行

### Q4: 连接失败
**现象：** 点击连接后显示"连接失败"

**解决方案：**
1. 确认测试服务器已启动
2. 确认端口正确：
   - WebSocket: 18080
   - TCP: 18888
3. 检查防火墙设置
4. 尝试使用 127.0.0.1 替代 localhost

---

## 📊 测试场景示例

### 场景1：完整WebSocket测试

**操作流程：**
1. 启动服务器和应用
2. 配置 WebSocket 连接
3. 点击连接 → 成功
4. 在数据交互面板发送消息："Hello WebSocket"
5. 查看PowerShell日志确认收到
6. 点击断开连接

**预期结果：**
- ✓ 连接成功
- ✓ 数据发送成功
- ✓ 服务器收到消息
- ✓ 断开成功

### 场景2：完整TCP测试

**操作流程：**
1. 切换协议为 TCP
2. 端口自动变为 18888
3. 点击连接 → 成功
4. 发送消息："Hello TCP"
5. 查看PowerShell日志
6. 断开连接

**预期结果：**
- ✓ 连接成功
- ✓ 数据发送成功
- ✓ 服务器收到消息
- ✓ 断开成功

---

## 🎨 界面截图说明

### 未连接状态
```
连接服务器 [🔌]   ← 蓝色按钮，可点击
```

### 连接中状态
```
连接中... [⏳]    ← 按钮变灰，禁用点击
```

### 已连接状态
```
已连接 [✓]        ← 绿色按钮，已连接
断开连接 [⚠]     ← 红色按钮，可断开
```

---

## 🔍 验证连接成功的标志

### 1. 应用界面标志
- ✅ 连接按钮状态变为"已连接"（绿色）
- ✅ 出现"断开连接"按钮（红色）
- ✅ 顶部状态提示显示"已连接"（绿色对勾）

### 2. 服务器日志标志
- ✅ PowerShell显示：`Client connected: 127.0.0.1`
- ✅ 显示SN参数：`SN: 你的设备ID`

### 3. 控制台日志标志（按F12打开）
- ✅ 浏览器控制台显示：`WebSocket connected` 或 `TCP connected`

---

## 📋 测试检查清单

在完成测试后，请确认：

- [ ] 测试服务器成功启动（显示两个端口）
- [ ] 应用窗口成功打开
- [ ] 可以看到连接配置面板
- [ ] 可以看到"连接服务器"按钮
- [ ] 点击连接后状态变为"已连接"
- [ ] PowerShell显示连接日志
- [ ] 可以正常断开连接
- [ ] 服务器显示断开日志

**全部打勾 = 测试通过！** ✓

---

## 💡 进阶技巧

### 1. 监控实时日志
**保持 `npm run test:servers` 窗口可见**，可以实时看到：
- 客户端连接
- 数据接收
- 客户端断开

### 2. 多次连接测试
- 连接 → 断开 → 连接 → 断开
- 验证重连机制

### 3. 异常测试
- 先关闭服务器，再尝试连接
- 观察错误提示和重试机制

### 4. 查看详细信息
- 按 `F12` 打开浏览器开发者工具
- 查看 Console 选项卡中的详细日志

---

## 📞 需要帮助？

如果仍然无法看到连接按钮或有其他问题：

1. **确认版本**：应用标题显示 "Dev-Linker 虚拟4G模块模拟器"
2. **检查控制台**：按 F12 查看是否有错误信息
3. **重启应用**：关闭应用，重新执行 `npm run preview`
4. **检查依赖**：执行 `npm install` 确保依赖完整

---

**文档版本：** V1.0
**更新日期：** 2025-11-18
**状态：** ✅ 验证通过
